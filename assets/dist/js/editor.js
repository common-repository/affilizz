/*! For license information please see editor.js.LICENSE.txt */
(()=>{var e={604:(e,t,n)=>{var i;!function(){"use strict";var r={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function o(e){return function(e,t){var n,i,a,l,s,c,u,d,f,p=1,h=e.length,m="";for(i=0;i<h;i++)if("string"==typeof e[i])m+=e[i];else if("object"==typeof e[i]){if((l=e[i]).keys)for(n=t[p],a=0;a<l.keys.length;a++){if(null==n)throw new Error(o('[sprintf] Cannot access property "%s" of undefined value "%s"',l.keys[a],l.keys[a-1]));n=n[l.keys[a]]}else n=l.param_no?t[l.param_no]:t[p++];if(r.not_type.test(l.type)&&r.not_primitive.test(l.type)&&n instanceof Function&&(n=n()),r.numeric_arg.test(l.type)&&"number"!=typeof n&&isNaN(n))throw new TypeError(o("[sprintf] expecting number but found %T",n));switch(r.number.test(l.type)&&(d=n>=0),l.type){case"b":n=parseInt(n,10).toString(2);break;case"c":n=String.fromCharCode(parseInt(n,10));break;case"d":case"i":n=parseInt(n,10);break;case"j":n=JSON.stringify(n,null,l.width?parseInt(l.width):0);break;case"e":n=l.precision?parseFloat(n).toExponential(l.precision):parseFloat(n).toExponential();break;case"f":n=l.precision?parseFloat(n).toFixed(l.precision):parseFloat(n);break;case"g":n=l.precision?String(Number(n.toPrecision(l.precision))):parseFloat(n);break;case"o":n=(parseInt(n,10)>>>0).toString(8);break;case"s":n=String(n),n=l.precision?n.substring(0,l.precision):n;break;case"t":n=String(!!n),n=l.precision?n.substring(0,l.precision):n;break;case"T":n=Object.prototype.toString.call(n).slice(8,-1).toLowerCase(),n=l.precision?n.substring(0,l.precision):n;break;case"u":n=parseInt(n,10)>>>0;break;case"v":n=n.valueOf(),n=l.precision?n.substring(0,l.precision):n;break;case"x":n=(parseInt(n,10)>>>0).toString(16);break;case"X":n=(parseInt(n,10)>>>0).toString(16).toUpperCase()}r.json.test(l.type)?m+=n:(!r.number.test(l.type)||d&&!l.sign?f="":(f=d?"+":"-",n=n.toString().replace(r.sign,"")),c=l.pad_char?"0"===l.pad_char?"0":l.pad_char.charAt(1):" ",u=l.width-(f+n).length,s=l.width&&u>0?c.repeat(u):"",m+=l.align?f+n+s:"0"===c?f+s+n:s+f+n)}return m}(function(e){if(l[e])return l[e];var t,n=e,i=[],o=0;for(;n;){if(null!==(t=r.text.exec(n)))i.push(t[0]);else if(null!==(t=r.modulo.exec(n)))i.push("%");else{if(null===(t=r.placeholder.exec(n)))throw new SyntaxError("[sprintf] unexpected placeholder");if(t[2]){o|=1;var a=[],s=t[2],c=[];if(null===(c=r.key.exec(s)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(a.push(c[1]);""!==(s=s.substring(c[0].length));)if(null!==(c=r.key_access.exec(s)))a.push(c[1]);else{if(null===(c=r.index_access.exec(s)))throw new SyntaxError("[sprintf] failed to parse named argument key");a.push(c[1])}t[2]=a}else o|=2;if(3===o)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");i.push({placeholder:t[0],param_no:t[1],keys:t[2],sign:t[3],pad_char:t[4],align:t[5],width:t[6],precision:t[7],type:t[8]})}n=n.substring(t[0].length)}return l[e]=i}(e),arguments)}function a(e,t){return o.apply(null,[e].concat(t||[]))}var l=Object.create(null);"undefined"!=typeof window&&(window.sprintf=o,window.vsprintf=a,void 0===(i=function(){return{sprintf:o,vsprintf:a}}.call(t,n,t,e))||(e.exports=i))}()}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,n),o.exports}(()=>{"use strict";n(604);!function(e,t){var n,i,r=0;function o(){var o,a,l=n,s=arguments.length;e:for(;l;){if(l.args.length===arguments.length){for(a=0;a<s;a++)if(l.args[a]!==arguments[a]){l=l.next;continue e}return l!==n&&(l===i&&(i=l.prev),l.prev.next=l.next,l.next&&(l.next.prev=l.prev),l.next=n,l.prev=null,n.prev=l,n=l),l.val}l=l.next}for(o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return l={args:o,val:e.apply(null,o)},n?(n.prev=l,l.next=n):i=l,r===t.maxSize?(i=i.prev).next=null:r++,n=l,l.val}t=t||{},o.clear=function(){n=null,i=null,r=0}}(console.error);var e,t,i,r;e={"(":9,"!":8,"*":7,"/":7,"%":7,"+":6,"-":6,"<":5,"<=":5,">":5,">=":5,"==":4,"!=":4,"&&":3,"||":2,"?":1,"?:":1},t=["(","?"],i={")":["("],":":["?","?:"]},r=/<=|>=|==|!=|&&|\|\||\?:|\(|!|\*|\/|%|\+|-|<|>|\?|\)|:/;var o={"!":function(e){return!e},"*":function(e,t){return e*t},"/":function(e,t){return e/t},"%":function(e,t){return e%t},"+":function(e,t){return e+t},"-":function(e,t){return e-t},"<":function(e,t){return e<t},"<=":function(e,t){return e<=t},">":function(e,t){return e>t},">=":function(e,t){return e>=t},"==":function(e,t){return e===t},"!=":function(e,t){return e!==t},"&&":function(e,t){return e&&t},"||":function(e,t){return e||t},"?:":function(e,t,n){if(e)throw t;return n}};function a(n){var a=function(n){for(var o,a,l,s,c=[],u=[];o=n.match(r);){for(a=o[0],(l=n.substr(0,o.index).trim())&&c.push(l);s=u.pop();){if(i[a]){if(i[a][0]===s){a=i[a][1]||a;break}}else if(t.indexOf(s)>=0||e[s]<e[a]){u.push(s);break}c.push(s)}i[a]||u.push(a),n=n.substr(o.index+a.length)}return(n=n.trim())&&c.push(n),c.concat(u.reverse())}(n);return function(e){return function(e,t){var n,i,r,a,l,s,c=[];for(n=0;n<e.length;n++){if(l=e[n],a=o[l]){for(i=a.length,r=Array(i);i--;)r[i]=c.pop();try{s=a.apply(null,r)}catch(e){return e}}else s=t.hasOwnProperty(l)?t[l]:+l;c.push(s)}return c[0]}(a,e)}}var l={contextDelimiter:"",onMissingKey:null};function s(e,t){var n;for(n in this.data=e,this.pluralForms={},this.options={},l)this.options[n]=void 0!==t&&n in t?t[n]:l[n]}s.prototype.getPluralForm=function(e,t){var n,i,r,o=this.pluralForms[e];return o||("function"!=typeof(r=(n=this.data[e][""])["Plural-Forms"]||n["plural-forms"]||n.plural_forms)&&(i=function(e){var t,n,i;for(t=e.split(";"),n=0;n<t.length;n++)if(0===(i=t[n].trim()).indexOf("plural="))return i.substr(7)}(n["Plural-Forms"]||n["plural-forms"]||n.plural_forms),r=function(e){var t=a(e);return function(e){return+t({n:e})}}(i)),o=this.pluralForms[e]=r),o(t)},s.prototype.dcnpgettext=function(e,t,n,i,r){var o,a,l;return o=void 0===r?0:this.getPluralForm(e,r),a=n,t&&(a=t+this.options.contextDelimiter+n),(l=this.data[e][a])&&l[o]?l[o]:(this.options.onMissingKey&&this.options.onMissingKey(n,e),0===o?n:i)};const c={plural_forms:e=>1===e?0:1},u=/^i18n\.(n?gettext|has_translation)(_|$)/;const d=function(e){return"string"!=typeof e||""===e?(console.error("The namespace must be a non-empty string."),!1):!!/^[a-zA-Z][a-zA-Z0-9_.\-\/]*$/.test(e)||(console.error("The namespace can only contain numbers, letters, dashes, periods, underscores and slashes."),!1)};const f=function(e){return"string"!=typeof e||""===e?(console.error("The hook name must be a non-empty string."),!1):/^__/.test(e)?(console.error("The hook name cannot begin with `__`."),!1):!!/^[a-zA-Z][a-zA-Z0-9_.-]*$/.test(e)||(console.error("The hook name can only contain numbers, letters, dashes, periods and underscores."),!1)};const p=function(e,t){return function(n,i,r,o=10){const a=e[t];if(!f(n))return;if(!d(i))return;if("function"!=typeof r)return void console.error("The hook callback must be a function.");if("number"!=typeof o)return void console.error("If specified, the hook priority must be a number.");const l={callback:r,priority:o,namespace:i};if(a[n]){const e=a[n].handlers;let t;for(t=e.length;t>0&&!(o>=e[t-1].priority);t--);t===e.length?e[t]=l:e.splice(t,0,l),a.__current.forEach((e=>{e.name===n&&e.currentIndex>=t&&e.currentIndex++}))}else a[n]={handlers:[l],runs:0};"hookAdded"!==n&&e.doAction("hookAdded",n,i,r,o)}};const h=function(e,t,n=!1){return function(i,r){const o=e[t];if(!f(i))return;if(!n&&!d(r))return;if(!o[i])return 0;let a=0;if(n)a=o[i].handlers.length,o[i]={runs:o[i].runs,handlers:[]};else{const e=o[i].handlers;for(let t=e.length-1;t>=0;t--)e[t].namespace===r&&(e.splice(t,1),a++,o.__current.forEach((e=>{e.name===i&&e.currentIndex>=t&&e.currentIndex--})))}return"hookRemoved"!==i&&e.doAction("hookRemoved",i,r),a}};const m=function(e,t){return function(n,i){const r=e[t];return void 0!==i?n in r&&r[n].handlers.some((e=>e.namespace===i)):n in r}};const v=function(e,t,n=!1){return function(i,...r){const o=e[t];o[i]||(o[i]={handlers:[],runs:0}),o[i].runs++;const a=o[i].handlers;if(!a||!a.length)return n?r[0]:void 0;const l={name:i,currentIndex:0};for(o.__current.push(l);l.currentIndex<a.length;){const e=a[l.currentIndex].callback.apply(null,r);n&&(r[0]=e),l.currentIndex++}return o.__current.pop(),n?r[0]:void 0}};const y=function(e,t){return function(){var n;const i=e[t];return null!==(n=i.__current[i.__current.length-1]?.name)&&void 0!==n?n:null}};const b=function(e,t){return function(n){const i=e[t];return void 0===n?void 0!==i.__current[0]:!!i.__current[0]&&n===i.__current[0].name}};const z=function(e,t){return function(n){const i=e[t];if(f(n))return i[n]&&i[n].runs?i[n].runs:0}};class g{constructor(){this.actions=Object.create(null),this.actions.__current=[],this.filters=Object.create(null),this.filters.__current=[],this.addAction=p(this,"actions"),this.addFilter=p(this,"filters"),this.removeAction=h(this,"actions"),this.removeFilter=h(this,"filters"),this.hasAction=m(this,"actions"),this.hasFilter=m(this,"filters"),this.removeAllActions=h(this,"actions",!0),this.removeAllFilters=h(this,"filters",!0),this.doAction=v(this,"actions"),this.applyFilters=v(this,"filters",!0),this.currentAction=y(this,"actions"),this.currentFilter=y(this,"filters"),this.doingAction=b(this,"actions"),this.doingFilter=b(this,"filters"),this.didAction=z(this,"actions"),this.didFilter=z(this,"filters")}}const _=function(){return new g}(),{addAction:w,addFilter:x,removeAction:k,removeFilter:S,hasAction:E,hasFilter:L,removeAllActions:I,removeAllFilters:C,doAction:q,applyFilters:F,currentAction:P,currentFilter:j,doingAction:A,doingFilter:O,didAction:B,didFilter:T,actions:U,filters:D}=_,M=((e,t,n)=>{const i=new s({}),r=new Set,o=()=>{r.forEach((e=>e()))},a=(e,t="default")=>{i.data[t]={...i.data[t],...e},i.data[t][""]={...c,...i.data[t]?.[""]},delete i.pluralForms[t]},l=(e,t)=>{a(e,t),o()},d=(e="default",t,n,r,o)=>(i.data[e]||a(void 0,e),i.dcnpgettext(e,t,n,r,o)),f=(e="default")=>e,p=(e,t,i)=>{let r=d(i,t,e);return n?(r=n.applyFilters("i18n.gettext_with_context",r,e,t,i),n.applyFilters("i18n.gettext_with_context_"+f(i),r,e,t,i)):r};if(e&&l(e,t),n){const e=e=>{u.test(e)&&o()};n.addAction("hookAdded","core/i18n",e),n.addAction("hookRemoved","core/i18n",e)}return{getLocaleData:(e="default")=>i.data[e],setLocaleData:l,addLocaleData:(e,t="default")=>{i.data[t]={...i.data[t],...e,"":{...c,...i.data[t]?.[""],...e?.[""]}},delete i.pluralForms[t],o()},resetLocaleData:(e,t)=>{i.data={},i.pluralForms={},l(e,t)},subscribe:e=>(r.add(e),()=>r.delete(e)),__:(e,t)=>{let i=d(t,void 0,e);return n?(i=n.applyFilters("i18n.gettext",i,e,t),n.applyFilters("i18n.gettext_"+f(t),i,e,t)):i},_x:p,_n:(e,t,i,r)=>{let o=d(r,void 0,e,t,i);return n?(o=n.applyFilters("i18n.ngettext",o,e,t,i,r),n.applyFilters("i18n.ngettext_"+f(r),o,e,t,i,r)):o},_nx:(e,t,i,r,o)=>{let a=d(o,r,e,t,i);return n?(a=n.applyFilters("i18n.ngettext_with_context",a,e,t,i,r,o),n.applyFilters("i18n.ngettext_with_context_"+f(o),a,e,t,i,r,o)):a},isRTL:()=>"rtl"===p("ltr","text direction"),hasTranslation:(e,t,r)=>{const o=t?t+""+e:e;let a=!!i.data?.[null!=r?r:"default"]?.[o];return n&&(a=n.applyFilters("i18n.has_translation",a,e,t,r),a=n.applyFilters("i18n.has_translation_"+f(r),a,e,t,r)),a}}})(void 0,void 0,_);M.getLocaleData.bind(M),M.setLocaleData.bind(M),M.resetLocaleData.bind(M),M.subscribe.bind(M),M.__.bind(M),M._x.bind(M),M._n.bind(M),M._nx.bind(M),M.isRTL.bind(M),M.hasTranslation.bind(M);function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o,a,l=[],s=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(i=o.call(n)).done)&&(l.push(i.value),l.length!==t);s=!0);}catch(e){c=!0,r=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw r}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return G(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function V(){V=function(){return t};var e,t={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",l=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(e,t,n,i){var o=t&&t.prototype instanceof y?t:y,a=Object.create(o.prototype),l=new q(i||[]);return r(a,"_invoke",{value:E(e,n,l)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",p="suspendedYield",h="executing",m="completed",v={};function y(){}function b(){}function z(){}var g={};c(g,a,(function(){return this}));var _=Object.getPrototypeOf,w=_&&_(_(F([])));w&&w!==n&&i.call(w,a)&&(g=w);var x=z.prototype=y.prototype=Object.create(g);function k(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function n(r,o,a,l){var s=d(e[r],e,o);if("throw"!==s.type){var c=s.arg,u=c.value;return u&&"object"==N(u)&&i.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,a,l)}),(function(e){n("throw",e,a,l)})):t.resolve(u).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,l)}))}l(s.arg)}var o;r(this,"_invoke",{value:function(e,i){function r(){return new t((function(t,r){n(e,i,t,r)}))}return o=o?o.then(r,r):r()}})}function E(t,n,i){var r=f;return function(o,a){if(r===h)throw Error("Generator is already running");if(r===m){if("throw"===o)throw a;return{value:e,done:!0}}for(i.method=o,i.arg=a;;){var l=i.delegate;if(l){var s=L(l,i);if(s){if(s===v)continue;return s}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===f)throw r=m,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=h;var c=d(t,n,i);if("normal"===c.type){if(r=i.done?m:p,c.arg===v)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=m,i.method="throw",i.arg=c.arg)}}}function L(t,n){var i=n.method,r=t.iterator[i];if(r===e)return n.delegate=null,"throw"===i&&t.iterator.return&&(n.method="return",n.arg=e,L(t,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),v;var o=d(r,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,v;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function q(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function F(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function n(){for(;++r<t.length;)if(i.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(N(t)+" is not iterable")}return b.prototype=z,r(x,"constructor",{value:z,configurable:!0}),r(z,"constructor",{value:b,configurable:!0}),b.displayName=c(z,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,z):(e.__proto__=z,c(e,s,"GeneratorFunction")),e.prototype=Object.create(x),e},t.awrap=function(e){return{__await:e}},k(S.prototype),c(S.prototype,l,(function(){return this})),t.AsyncIterator=S,t.async=function(e,n,i,r,o){void 0===o&&(o=Promise);var a=new S(u(e,n,i,r),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},k(x),c(x,s,"Generator"),c(x,a,(function(){return this})),c(x,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var i in t)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},t.values=F,q.prototype={constructor:q,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(i,r){return l.type="throw",l.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],l=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;C(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:F(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),v}},t}function $(e,t,n,i,r,o,a){try{var l=e[o](a),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(i,r)}function J(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function a(e){$(o,i,r,a,l,"next",e)}function l(e){$(o,i,r,a,l,"throw",e)}a(void 0)}))}}function Q(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,W(i.key),i)}}function W(e){var t=function(e,t){if("object"!=N(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=N(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==N(t)?t:t+""}var X=function(e){return(new DOMParser).parseFromString(e,"text/html").documentElement.textContent};function Z(){var e=this;if(!jQuery.fn.sortable)throw new Error('The "affilizzTomSelectDragDrop" plugin requires jQuery UI "sortable".');if("multi"===e.settings.mode){var t=e.lock,n=e.unlock;e.hook("instead","lock",(function(){var n=jQuery(e.control).data("sortable");return n&&n.disable(),t.call(e)})),e.hook("instead","unlock",(function(){var t=jQuery(e.control).data("sortable");return t&&t.enable(),n.call(e)})),e.on("initialize",(function(){var t=jQuery(e.control).sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:!1,start:function(e,n){n.placeholder.css("width",n.helper.css("width")),t.css({overflow:"visible"})},stop:function(){t.css({overflow:"hidden"});var n=[];t.children("[data-value]").each((function(){this.dataset.value&&n.push(this.dataset.value)})),e.setValue(n)}})}))}}var K=function(){return e=function e(t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isLoadingPublications=!1,this.isLoadingPublicationContents=!1,this.hasLoadedFirstTime=!1,this.updateId(null!==(n=t.id)&&void 0!==n?n:null),this.getUniqueId(),this.containerSelector=null!==document.querySelector("#affilizz-modal-gutenberg")?"#affilizz-modal-gutenberg":"#affilizz-modal",this.addEventListeners(),this.publicationIdSelector&&(this.publicationIdSelector.destroy(),this.publicationIdSelector=null),this.qualifiedAvailablePublicationContents=[]},t=[{key:"updateId",value:function(e){this.currentUniqueId=null!=e?e:null,null!=this.currentUniqueId&&(document.querySelector('[name="original-affilizz-publication-id"]').value=this.currentUniqueId),this.mode=e?"edit":"create"}},{key:"getUniqueId",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.currentUniqueId&&0!=this.currentUniqueId.length&&void 0!==this.currentUniqueId&&"null"!=this.currentUniqueId||(this.currentUniqueId=Math.random().toString(36).substr(2,9),""!=e&&(this.currentUniqueId=e+"-"+this.currentUniqueId),this.mode="create"),this.currentUniqueId}},{key:"open",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return document.activeElement.blur(),document.getElementById("affilizz-modal-logo").click(),e&&document.querySelector("#affilizz-modal").replaceChildren(),document.querySelector(".affilizz-modal").classList.add("visible"),this}},{key:"close",value:function(){return document.querySelector(".affilizz-modal").classList.remove("visible"),window.dispatchEvent(new CustomEvent("affilizz:close")),this}},{key:"title",value:function(e,t){return document.querySelector(".affilizz-modal__overtitle").textContent=void 0===t?"":t.substr(0,64).trim()+(t.length>63?"&hellip;":""),document.querySelector(".affilizz-modal__title").textContent=e,this}},{key:"body",value:function(e){return document.querySelector(this.containerSelector).innerHTML=e,this}},{key:"addEventListeners",value:function(){this.removeEventListeners(),this.eventCloseBind=this.eventClose.bind(this),this.eventEscapeBind=this.eventEscape.bind(this),this.eventSubmitBind=this.eventSubmit.bind(this),this.eventRefreshBind=this.eventRefresh.bind(this),this.eventWindowFocusBind=this.eventWindowFocus.bind(this),document.addEventListener("click",this.eventCloseBind,!0),document.addEventListener("keydown",this.eventEscapeBind,!0),document.addEventListener("click",this.eventSubmitBind,!0),document.addEventListener("click",this.eventRefreshBind,!0),document.addEventListener("visibilitychange",this.eventWindowFocusBind,!0)}},{key:"removeEventListeners",value:function(){document.removeEventListener("click",this.eventCloseBind,!0),document.removeEventListener("keydown",this.eventEscapeBind,!0),document.removeEventListener("click",this.eventSubmitBind,!0),document.removeEventListener("click",this.eventRefreshBind,!0),document.removeEventListener("visibilitychange",this.eventWindowFocusBind,!0)}},{key:"eventClose",value:function(e){if(e.target.classList.contains("affilizz-modal__close"))return e.preventDefault(),this.close(),!1}},{key:"eventEscape",value:function(e){27===e.keyCode&&this.close()}},{key:"eventSubmit",value:function(e){if(e.target.closest('input[name="affilizz-modal-submit"]'))return e.preventDefault(),window.dispatchEvent(new CustomEvent("affilizz:save",{detail:{id:this.getUniqueId(),mode:this.mode}})),this.save(),this.close(),!1}},{key:"eventWindowFocus",value:(s=J(V().mark((function e(t){return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!document.hidden&&this.hasLoadedFirstTime&&this.refreshContent(t),e.abrupt("return",this);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"hideMessage",value:function(){document.querySelector(".affilizz-modal__content--default").style.display="block",document.querySelector(".affilizz-modal__content--message").style.display="none",document.querySelector("#affilizz-refresh-lists").style.display="block",document.querySelector(".affilizz-modal__actions").style.display="block",document.querySelector(".affilizz-modal").classList.remove("has-error"),["error","message","information","success","warning"].forEach((function(e){document.querySelector(".affilizz-modal").classList.remove("message-"+e)}))}},{key:"displayMessage",value:function(e,t,n,i,r,o){document.querySelector(".affilizz-modal").classList.add("has-error"),document.querySelector(".affilizz-modal").classList.add("message-"+e),this.title(r,i),void 0===t?(document.querySelector(".affilizz-modal-message__title").style.display="none",document.querySelector(".affilizz-modal-message__title").textContent=""):(document.querySelector(".affilizz-modal-message__title").style.display="block",document.querySelector(".affilizz-modal-message__title").textContent=t),void 0===t?(document.querySelector(".affilizz-modal-message__content").style.display="none",document.querySelector(".affilizz-modal-message__content").textContent=""):(document.querySelector(".affilizz-modal-message__content").style.display="block",document.querySelector(".affilizz-modal-message__content").textContent=n),document.querySelector("#affilizz-refresh-lists").style.display="none",document.querySelector(".affilizz-modal__content--default").style.display="none",document.querySelector(".affilizz-modal__actions").style.display="none",document.querySelector(".affilizz-modal__content--message").style.display="block"}},{key:"eventRefresh",value:(l=J(V().mark((function e(t){return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.target.closest("#affilizz-refresh-lists")){e.next=3;break}return this.refreshContent(t,!0),e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"refreshContent",value:(a=J(V().mark((function e(t){var n,i,r,o,a,l,s=this,c=arguments;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>1&&void 0!==c[1]&&c[1],i=c.length>2&&void 0!==c[2]?c[2]:"",r=document.querySelector('[name="original-affilizz-publication-id"]').value,o=this.publicationIdSelector,this.showPublicationLoader(),this.showPublicationContentLoader(),"edit"==this.mode?(document.querySelector('[name="affilizz-modal-submit"]').value=affilizz_admin_l10n.modal.button.update,this.title(affilizz_admin_l10n.modal.title.update,affilizz_admin_l10n.modal.overtitle.update)):(document.querySelector('[name="affilizz-modal-submit"]').value=affilizz_admin_l10n.modal.button.insert,this.title(affilizz_admin_l10n.modal.title.insert,affilizz_admin_l10n.modal.overtitle.insert)),a=ajaxurl+"?action=affilizz_get_publications&current_id="+r+"&context_id="+this.getUniqueId()+"&force="+(n?1:0)+"&search="+i,l=this,e.next=11,fetch(a).then((function(e){if(!e.ok)throw new Error("Error thrown in modal while populating content IDs.");return e.json()})).then((function(e){if(e.publications){o.clear(),o.setValue(null,!0),o.clearOptions(),o.disable(),document.querySelector('[name="affilizz-publication-id"]').replaceChildren(),Object.keys(e.publications).forEach((function(t){var n=document.createElement("option");n.value=t,n.text=e.publications[t].name,n.dataset.recent=e.publications[t].recent?"1":"0",document.querySelector('[name="affilizz-publication-id"]').add(n),o.addOption({value:e.publications[t].value,text:e.publications[t].name,dataset:{recent:e.publications[t].recent?"1":"0"}})}));var t=e.currently_selected&&""!=e.currently_selected?e.currently_selected:"";void 0!==t&&""!=t||(t=o.options[Object.keys(o.options)[0]].value),o.setValue(t),l.populatePublicationContentIds(t,l.getUniqueId()),o.refreshOptions()}s.hidePublicationLoader()})).catch((function(e){s.hidePublicationLoader()}));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"loadContent",value:(o=J(V().mark((function e(){var t,n=this;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ajaxurl+"?action=edit_affilizz_publication_shortcode&id="+this.getUniqueId(),e.next=3,fetch(t).then((function(e){if(!e.ok)throw new Error("Error thrown in modal while creating the modal.");return e.json()})).then((function(e){n.body(e.render),n.enhance(),"edit"==n.mode?(document.querySelector('[name="affilizz-modal-submit"]').value=affilizz_admin_l10n.modal.button.update,n.title(affilizz_admin_l10n.modal.title.update,affilizz_admin_l10n.modal.overtitle.update)):(document.querySelector('[name="affilizz-modal-submit"]').value=affilizz_admin_l10n.modal.button.insert,n.title(affilizz_admin_l10n.modal.title.insert,affilizz_admin_l10n.modal.overtitle.insert))})).catch((function(e){n.hideLoader()}));case 3:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"enhance",value:function(){var e=this;if(void 0!==document.querySelector("#affilizz-publication-id")&&void 0===this.publicationIdSelector){document.querySelector('[name="affilizz-publication-id"]').addEventListener("change",(function(t){e.populatePublicationContentIds(document.querySelector('[name="affilizz-publication-id"]').value,e.getUniqueId())}));var t=this;this.publicationIdSelector=new TomSelect("#affilizz-publication-id",{plugins:["dropdown_input"],shouldLoad:function(e){return e.length>1},load:function(e,n){var i=document.querySelector('[name="original-affilizz-publication-id"]').value,r=ajaxurl+"?action=affilizz_get_publications&current_id="+i+"&context_id="+t.getUniqueId()+"&force=1&search="+encodeURIComponent(e);this.clearOptions((function(e,t){return!0})),fetch(r,{cache:"no-store"}).then((function(e){return e.json()})).then((function(e){n(e.publications)})).catch((function(e){}))},render:{option:function(e,t){return"<div>"+e.text+(1==e.recent?'<span class="recent">'+affilizz_admin_l10n.modal.recent+"</span>":"")+"</div>"},loading:function(){return'<div class="affilizz-inline-loader"><img src="'+affilizz_admin_l10n.plugin.url+'/assets/dist/images/logo/logo-type-green.svg" class="affilizz-modal__logo"width="40" />Loading in progress...</div>'},item:function(e,t){return"<div>"+e.text+(1==e.recent?'<span class="recent">'+affilizz_admin_l10n.modal.recent+"</span>":"")+"</div>"}}})}return void 0!==document.querySelector("#affilizz-publication-content-id")&&(void 0!==this.publicationContentIdSelector?this.publicationContentIdSelector.clearOptions((function(e,t){return!0})):(TomSelect.define("affilizzTomSelectDragDrop",Z),this.publicationContentIdSelector=new TomSelect("#affilizz-publication-content-id",{searchField:"name",plugins:{affilizzTomSelectDragDrop:{},remove_button:{title:affilizz_admin_l10n.modal.list.remove}},render:{option:function(e,t){var n,i=null!==(n=e.type)&&void 0!==n?n:"default";if("loader"==i)return"<div>"+e.text+"</div>";var r=X(t(e.name));return""==r&&(r='<span class="affilizz-empty-publication-content-name">'+affilizz_admin_l10n.modal.list.emptyPublicationContentName+"</span>"),'<div><div class="affilizz-select-option affilizz-select-option--content-type-'+i+'"><img src="'+affilizz_admin_l10n.plugin.url+"/assets/dist/images/content-type/"+i+'.svg" width="12" /><span class="affilizz-type-icon affilizz-type-icon--'+i+'">'+affilizz_admin_l10n.constants.types[i]+'</span></div><span class="affilizz-select-option--text text">'+r+"</span></div>"},item:function(e,t){var n,i=null!==(n=e.type)&&void 0!==n?n:"default";if("loader"==i)return"<div>"+e.text+"</div>";var r=X(t(e.name));return""==r&&(r='<span class="affilizz-empty-publication-content-name">'+affilizz_admin_l10n.modal.list.emptyPublicationContentName+"</span>"),'<div class="affilizz-select-item affilizz-select-item--content-type-'+i+'"><img src="'+affilizz_admin_l10n.plugin.url+"/assets/dist/images/content-type/"+i+'.svg" width="12" />&nbsp;&nbsp;<span class="affilizz-select-option--text text">'+r+"</span></div>"}}}))),this.hasLoadedFirstTime=!0,this}},{key:"showPublicationLoader",value:function(){this.isLoadingPublications||(this.isLoadingPublications=!0,document.getElementById("affilizz-publication-id-loader").classList.add("visible"),document.getElementById("affilizz-publication-id-loader").classList.remove("hidden"),document.getElementById("affilizz-publication-id-wrapper").classList.add("hidden"),document.getElementById("affilizz-publication-id-wrapper").classList.remove("visible"))}},{key:"showPublicationContentLoader",value:function(){this.isLoadingPublicationContents||(document.getElementById("affilizz-publication-content-id-loader").classList.add("visible"),document.getElementById("affilizz-publication-content-id-loader").classList.remove("hidden"),document.getElementById("affilizz-publication-content-id-wrapper").classList.add("hidden"),document.getElementById("affilizz-publication-content-id-wrapper").classList.remove("visible"))}},{key:"showLoader",value:function(){null!==document.querySelector(".affilizz-loader")&&(document.querySelector(".affilizz-loader").style.visibility="visible")}},{key:"hidePublicationLoader",value:function(){this.isLoadingPublications=!1,void 0!==this.publicationIdSelector&&this.publicationIdSelector.enable(),document.getElementById("affilizz-publication-id-loader").classList.remove("visible"),document.getElementById("affilizz-publication-id-loader").classList.add("hidden"),document.getElementById("affilizz-publication-id-wrapper").classList.remove("hidden"),document.getElementById("affilizz-publication-id-wrapper").classList.add("visible")}},{key:"hidePublicationContentLoader",value:function(){this.isLoadingPublicationContents=!1,void 0!==this.publicationContentIdSelector&&this.publicationContentIdSelector.enable(),document.getElementById("affilizz-publication-content-id-loader").classList.remove("visible"),document.getElementById("affilizz-publication-content-id-loader").classList.add("hidden"),document.getElementById("affilizz-publication-content-id-wrapper").classList.remove("hidden"),document.getElementById("affilizz-publication-content-id-wrapper").classList.add("visible")}},{key:"hideLoader",value:function(){null!==document.querySelector(".affilizz-loader")&&(document.querySelector(".affilizz-loader").style.visibility="hidden")}},{key:"populatePublicationContentIds",value:(r=J(V().mark((function e(t,n){var i,r,o,a,l,s,c=this;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t&&""!=t){e.next=2;break}return e.abrupt("return");case 2:return i=this,(r=this.publicationContentIdSelector).clear(),r.setValue(null,!0),r.clearOptions(),r.disable(),this.showPublicationContentLoader(),o=ajaxurl+"?action=affilizz_get_publication_contents&publication_id="+t+"&context_id="+n,a=affilizz_admin_l10n.modal.configuration.media,l=t,void 0!==a&&0!=a&&""!=a.trim()&&void 0!==l&&""!=l.trim()&&void 0!==document.querySelector("#affilizz-publication-id")&&void 0!==affilizz_admin_l10n.constants.urls.edit?(s=affilizz_admin_l10n.constants.urls.edit.replace("##media##",a).replace("##publication##",l),document.getElementById("affilizz-edit-publication-link").href=s,document.getElementById("affilizz-edit-publication-call").classList.add("visible"),document.getElementById("affilizz-edit-publication-call").classList.remove("hidden")):(document.getElementById("affilizz-edit-publication-call").classList.add("visible"),document.getElementById("affilizz-edit-publication-call").classList.remove("hidden")),e.next=15,fetch(o).then((function(e){if(!e.ok)throw new Error("Error thrown in modal while populating content IDs.");return e.json()})).then((function(e){if(e){for(var t in i.availablePublicationContents=[],i.selectedPublicationContents=[],e){var n={value:t,name:e[t].name,type:e[t].type};i.availablePublicationContents.push(n),i.qualifiedAvailablePublicationContents[t]=n,e[t].selected&&i.selectedPublicationContents.push(t)}1==e.length&&i.selectedPublicationContents.push(e.keys()[0]),r.addOptions(i.availablePublicationContents,!0),r.setValue(i.selectedPublicationContents,!0),r.enable(),c.hidePublicationContentLoader()}})).catch((function(e){r.clear(),r.disable(),c.hidePublicationContentLoader()}));case 15:return e.abrupt("return",this);case 16:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"save",value:(i=J(V().mark((function e(){var t,n,i,r,o,a,l,s,c,u=this;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(this.selectedPublicationContents=[],t=this,this.publicationContentIdSelector.getValue().forEach((function(e,n){u.selectedPublicationContents.push({id:e,name:t.qualifiedAvailablePublicationContents[e].name,type:t.qualifiedAvailablePublicationContents[e].type})})),n=ajaxurl+"?action=affilizz_save_shortcode",i=document.querySelector('[name="affilizz-publication-id"]').selectedOptions[0].value,r={id:this.getUniqueId(i),post:void 0!==affilizz_admin_l10n.variables.current_post?affilizz_admin_l10n.variables.current_post:0,user:void 0!==affilizz_admin_l10n.variables.current_user?affilizz_admin_l10n.variables.current_user:0,publication_name:encodeURIComponent(document.querySelector('[name="affilizz-publication-id"]').selectedOptions[0].label),publication_id:i,publication_contents:encodeURIComponent(JSON.stringify(this.selectedPublicationContents))},o=0,a=Object.entries(r);o<a.length;o++)l=R(a[o],2),s=l[0],c=l[1],n=n+"&"+s+"="+c;return e.next=9,fetch(n).then((function(e){if(!e.ok)throw new Error("Error thrown in modal while saving data.");return e.json()})).then((function(e){window.dispatchEvent(new CustomEvent("affilizz:saved",{detail:e})),u.hideLoader()}));case 9:return e.abrupt("return",this);case 10:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})}],t&&Q(e.prototype,t),n&&Q(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,i,r,o,a,l,s}(),H=null,Y=[],ee=[];document.addEventListener("DOMContentLoaded",(function(e){null!=document.getElementById("affilizz-modal")&&(window.affilizzModal=new K({}),window.affilizzModal.loadContent()),wp.mce=wp.mce||{},wp.media&&(wp.mce["affilizz-publication"]={shortcode_data:{},template:wp.media.template("affilizz-publication-block"),getContent:function(){var e,t=this.shortcode.attrs.named;if(void 0!==t.id&&Y.includes(t.id))return this.template(t);t.render=null;var n=void 0!==t.id&&0!=t.id&&void 0!==ee&&void 0!==ee[t.id]?0:1;n&&delete ee[t.id];var i=ajaxurl+"?action=affilizz_render_shortcode&id="+(null!==(e=t.id)&&void 0!==e?e:0)+"&cache="+n,r=new XMLHttpRequest;if(r.open("GET",i,!1),r.send(null),200===r.status){var o=JSON.parse(r.responseText);t.render=o.render}return void 0!==t.id&&Y.push(t.id),this.template(t)},edit:function(e){wp.mce["affilizz-publication"].modal(tinyMCE.activeEditor,wp.shortcode.next("affilizz-publication",e).shortcode.attrs.named)},modal:function(e,t,n){(t=t||[]).id&&0!=t.id.length&&void 0!==t.id&&"null"!=t.id||(t.id=""),"function"!=typeof n&&(n=function(e,t){var n={tag:"affilizz-publication",type:"single",attrs:{id:t.id}};tinymce.editors.content.focus(),tinymce.activeEditor.selection.moveToBookmark(H),tinymce.activeEditor.selection.setContent(wp.shortcode.string(n))}),JSON.parse(JSON.stringify(t)).render=null,Y.push(t.id),window.affilizzModal.updateId(t.id),window.affilizzModal.open(!1),window.affilizzModal.refreshContent(),void 0===tinymce.activeEditor||null==tinymce.activeEditor?window.affilizzModal.displayMessage("error",affilizz_admin_l10n.modal.messages.missingBookmark.title,affilizz_admin_l10n.modal.messages.missingBookmark.content,affilizz_admin_l10n.modal.messages.type.error,affilizz_admin_l10n.modal.messages.missingBookmark.overtitle):(window.affilizzModal.hideMessage(),H=tinymce.activeEditor.selection.getBookmark())}},wp.mce.views.register("affilizz-publication",wp.mce["affilizz-publication"]),window.addEventListener("affilizz:saved",(function(e){var t={tag:"affilizz-publication",type:"single",attrs:{id:e.detail.id}};Y=Y.filter((function(t){return t!==e.detail.id})),ee[e.detail.id]=!0,void 0!==tinymce.editors.content&&(tinymce.editors.content.focus(),tinymce.activeEditor.selection.moveToBookmark(H),tinymce.activeEditor.selection.setContent(wp.shortcode.string(t)))})),window.addEventListener("click",(function(e){if(e.target.classList.contains("insert-affilizz-publication"))return e.preventDefault(),wp.mce["affilizz-publication"].modal(window.wp.editor),!1})))}))})()})();